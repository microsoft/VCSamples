<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>IMAGE Sample: Creates an ActiveX Control That Downloads Asynchronously</title></head><body><h1>IMAGE Sample: Creates an ActiveX Control That Downloads Asynchronously</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>The IMAGE sample demonstrates how to use MFC to build an ActiveX control that is capable of downloading data asynchronously. The control has a property based on the <MSHelp:link keywords="1F96EFDB-54E4-460B-862C-EBA5D4103488" tabindex="0" >CDataPathProperty</MSHelp:link> class.</p><p>The IMAGE control can display a bitmap image from a BMP file (but does not support BMP files with greater than 8-bit color depth, so files containing more than 256 colors cannot be displayed.) The <code>ImagePath</code> property of the control provides a path to the image. If the image is large and the download takes place over a slow link, the asynchronous support built into the <b>CDataPathProperty</b> object managing the path becomes active and renders the data to the control's painting code without blocking other processing.</p><p>The control features a simple property page that gives access to the <code>ImagePath</code> property as well as the <code>AutoSize</code> property. The <code>AutoSize</code> property, if set to <b>TRUE</b>, automatically snaps the size of the control to the size of the image it contains. If the <code>AutoSize</code> property is <b>FALSE</b>, the automatic sizing is disabled.</p><p>The image control also implements a read-only Boolean property named <code>ReadyState</code>. <code>ReadyState</code> is <b>TRUE</b> if the control has successfully read and presented all the data in the image stream. <code>ReadyState</code> is <b>FALSE</b> until the control is fully initialized.</p><p>See Controls Samples for details on adding a control to the Toolbox, manually registering a control, and using the ActiveX Control Test Container.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>Some samples, such as this one, have not been modified to reflect the changes in the Visual C++ wizards, libraries, and compiler, but still demonstrate how to complete your desired task. </p></td></tr></table></div><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :IMAGE Sample: Creates an ActiveX Control That Downloads Asynchronously">comments</a> about this topic to Microsoft.
      </div></div></body></html>
