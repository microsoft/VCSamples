<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>ACTIVEDOC Sample: Implements an Active Document Server</title></head><body><h1>ACTIVEDOC Sample: Implements an Active Document Server</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>The ACTIVEDOC sample demonstrates how to implement an Active Document Server. The sample demonstrates the following:  </p><ul><li><p>How to implement the interfaces <b>IOleDocument</b> and <b>IOleDocumentView</b>.</p></li><li><p>How to perform menu merging with the container.</p></li><li><p>How to implement a toolbar in your object.</p></li><li><p>How to override the <b>IPersistStreamInit</b> methods <b>Load</b> and <b>Save</b> to perform custom saving and loading.</p></li><li><p>How to use <b>CDialogImpl</b> to implement an About dialog box.</p></li><li><p>How to subclass the Rich Text Edit Control.</p></li></ul><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h4 class="subHeading">To build the sample</h4><div class="subSection"><ol><li><p>Open the solution ActiveDoc.sln.</p></li><li><p>From the <b>Build</b> menu, click <b>Build Solution</b>.</p></li></ol></div><h4 class="subHeading">To run the sample using Internet Explorer</h4><div class="subSection"><ol><li><p>Open ActiveDoc.htm or the ActiveDoc.AAA generated file in Internet Explorer (to open ActiveDoc.AAA, click the <b>Open</b> button when prompted to open this file).</p></li><li><p>Use the Format menu that has been merged into Internet Explorer's menu bar, or just click the toolbar colors to change the color of the typed text.</p></li></ol></div><h4 class="subHeading">To run the sample using Microsoft Office Binder</h4><div class="subSection"><ol><li><p>Run Microsoft Office Binder and from the <b>Section</b> menu click <b>Add</b>.</p></li><li><p>Select the icon labeled "ActiveDoc Class" and click <b>OK</b>.  </p><p>You should see the object embedded in Office Binder. Notice that the menus have been merged and the ActiveDoc's toolbar is shown. You can enter text and use the menu and toolbar buttons to change the color of the text that is typed. </p></li></ol></div></div><h1 class="heading">Sample Files</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>The sample includes the following main files:  </p><ul><li><p>ActiveCtl.h</p></li><li><p>ActiveCtl.cpp — implements <b>CActiveDoc</b>, which represents the overall <b>ActiveDoc</b> object.</p></li><li><p>OleDocument.h — contains the implementation of the <b>IOleDocument</b> and <b>IOleDocumentView</b> interfaces.</p></li><li><p>Toolbar.h — contains <b>CToolbar</b>, which helps with the implementation of the toolbar.</p></li></ul></div><h1 class="heading">Keywords</h1><div id="sectionSection2" class="seeAlsoNoToggleSection"><p>This sample uses the following keywords:</p><p>ActiveXDocActivate; ALT_MSG_MAP; ATLASSERT; ATLTRACE; BEGIN_COM_MAP; BEGIN_MSG_MAP; BEGIN_OBJECT_MAP; BEGIN_PROPERTY_MAP; BEGIN_TOOLBAR_MAP; CAboutDlg::DoModal; CanInPlaceActivate; CComCoClass; CComControl; CComModule::GetClassObject; CComModule::GetLockCount; CComModule::Init; CComModule::RegisterServer; CComModule::Term; CComModule::UnregisterServer; CComObjectRoot; CComObjectRootEx::InternalQueryInterface; CComPtr; CHARFORMAT; CMenu; COM_INTERFACE_ENTRY; COM_INTERFACE_ENTRY_IMPL; COMMAND_ID_HANDLER; COMMAND_RANGE_HANDLER; CreateMenu; CreateRTFWindow; CreateToolbar; CreateWindowEx; CToolbar; CWindow::DestroyWindow; CWindow::ModifyStyle; CWindow::SetFocus; CWindow::SetParent; CWindow::SetWindowPos; DECLARE_REGISTRY_RESOURCEID; DestroyMenu; DestroyToolbar; DisableThreadLibraryCalls; DllMain; DoesVerbUIActivate; EDITSTREAM::dwCookie; EDITSTREAM::dwError; EDITSTREAM::pfnCallback; Ellipse; END_COM_MAP; END_MSG_MAP; END_OBJECT_MAP; END_PROPERTY_MAP; END_TOOLBAR_MAP; EndDialog; ExtTextOut; FreeLibrary; GetMenuItemCount; GetMenuItemID; GetMenuState; GetMenuString; GetResourceInstance; GetStockObject; GetSubMenu; GetTextMetrics; GetWindow; GetWindowContext; GetWindowRect; HDC; hdcDraw;; IDataObjectImpl; IDispatchImpl; InitCommonControls; InlineIsEqualGUID; InPlaceDeactivate; InPlaceMenuCreate; InPlaceMenuDestroy; InsertMenu; InterfaceSupportsErrorInfo; InternalQueryInterface; IOleControlImpl; IOleDocument::GetDocMiscStatus; IOleDocumentImpl; IOleDocumentView::ApplyViewState; IOleDocumentView::SetInPlaceSite; IOleDocumentViewImpl; IOleInPlaceActiveObjectImpl; IOleInPlaceFrame*   pFrame;; IOleInPlaceFrame::InsertMenus; IOleInPlaceFrame::Release; IOleInPlaceFrame::SetMenu; IOleInPlaceObjectWindowlessImpl; IOLEInPlaceSite::GetWindowContext; IOleObjectImpl; IPersistStorageImpl; IPersistStreamInitImpl; IProvideClassInfo2Impl; IQuickActivateImpl; ISupportErrorImpl; IViewObjectExImpl; LoadLibrary; LoadMenu; LoadString; MAKEINTRESOURCE; MergeMenus; MESSAGE_HANDLER; NOTIFY_CODE_HANDLER; OBJECT_ENTRY; OleCreateMenuDescriptor; OLEINPLACEFRAMEINFO; OnInPlaceActivate; OnUIActivate; prcBounds; RECT rcPos, rcClip;; RemoveMenu; SelectObject; SendMessage; SetActiveObject; SetBkMode; SetBorderSpace; SetControlFocus; SetFocus; SetInPlaceSite; SetMenu; SetObjectRects; SetTextColor; ShowObject; ShowWindow; UIActivate; UIDeactivate; UnmergeMenus; ZeroMemory</p></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :ACTIVEDOC Sample: Implements an Active Document Server">comments</a> about this topic to Microsoft.
      </div></div></body></html>
