<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>DBViewer Sample: Database Browser</title></head><body><h1>DBViewer Sample: Database Browser</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>The DBViewer sample is an enhancement of the MFC DAOVIEW sample. It demonstrates a mid-level application that relies on the OLE DB Templates <b>CManualAccessor</b> class. This sample illustrates how to take full control of the bindings and use them for your applications.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><p>You can use DBViewer with the ODBC provider, and with the Microsoft Access 97 and Microsoft SQL Server 6.5 databases (or later versions). However, DBViewer cannot handle SQL Server stored procedures with integer parameters, or with names consisting of more than one word, for example, <code>My stored procedure</code>. You will get errors in these cases.</p><h4 class="subHeading">To build and run this sample</h4><div class="subSection"><ol><li><p>Open the solution file DBViewer.sln.</p></li><li><p>From the <b>Build</b> menu, click <b>Build</b>.</p></li><li><p>From the <b>Debug</b> menu, click <b>Start Without Debugging</b>. </p><p>A DBViewer dialog box will appear, with two panes. </p></li><li><p>Click <b>Open</b> from the <b>File</b> menu. The <b>Data Link Properties</b> dialog box will appear. On the <b>Provider</b> tab, select Microsoft OLE DB Provider for SQL Server (or Microsoft Jet 4.0 OLE DB Provider). On the <b>Connection</b> tab, select a database such as Northwind. </p><p>The specified database's tables and stored procedures will appear in the tree view pane on the left. </p></li><li><p>Once you have connected to a data source, you can manipulate the data, call the stored procedures, and view the schema information. The tree view on the left side of the application window displays the tables and the stored procedures. To view or modify data, right-click a table or a stored procedure, and a shortcut menu will appear with additional operations.</p></li></ol></div></div><h1 class="heading">How the Sample Works</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>Once DBViewer connects to a data source via the enumerator support, you can manipulate the data, call the stored procedures, and view the schema information. The tree view on the left side of the application window displays the tables and the stored procedures. To view or modify data, right-click a table or a stored procedure, and a shortcut menu will appear with additional operations.</p><p>This sample contains code to support stored procedures. However, you will find that not all stored procedures will run under this sample. This is because the underlying ODBC drivers do not provide support for some OLE DB methods. DBViewer does support multiple-result sets. If you click the list view where the data is located, you may see the <b>multiple result sets</b> button highlighted on the toolbar. You can click it and obtain the next result set.</p><p>DBViewer demonstrates how to use the error information in your application. The <code>CErrorsDialog</code> class handles the <b>IErrorRecords</b> interface and displays the error information returned from a particular call.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>Some of the samples, such as this one, have not been modified to reflect the changes in the Visual C++ wizards, libraries, and compiler, but still demonstrate how to complete your desired task.</p></td></tr></table></div></div><h1 class="heading">Keywords</h1><div id="sectionSection2" class="seeAlsoNoToggleSection"><p>The sample demonstrates the following classes:</p><p>CManualAccessor, CErrorsDialog</p><p>The sample demonstrates the following interfaces:</p><p>IErrorRecords</p></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :DBViewer Sample: Database Browser">comments</a> about this topic to Microsoft.
      </div></div></body></html>
