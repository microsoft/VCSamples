<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>ATLAgent Attributes Sample: Uses CCommand and CAccessor to Read Information from a Database</title></head><body><h1>ATLAgent Attributes Sample: Uses CCommand and CAccessor to Read Information from a Database</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>The ATLAgent attributes sample reads instructions from a database using the OLE DB Consumer Template classes. These instructions are used to command the Microsoft Agent control. The sample demonstrates how to use the <b>CCommand</b> and <b>CAccessor</b> classes to read information from a database and how to use the compiler COM support to control the Microsoft Agent.</p><p>The <MSHelp:link keywords="0C23AE3E-AB6E-415B-A80C-6E8800F661CB" tabindex="0" >ATLAgent sample</MSHelp:link> is the nonattributed version of this sample.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h4 class="subHeading">To install the Microsoft Agent control</h4><div class="subSection"><ol><li><p>Download the Microsoft Agent control from xt >http://www.microsoft.com/msagent/</linkText> (Web links can change without notice). </p></li><li><p>Optionally, download the text-to-speech engine available from the same page to allow the agent to speak.</p></li><li><p>Choose the link to download the Microsoft Agent character animation files and download one or more of the character .acs files. By default the ATLAgent control uses the Merlin-with-sound-effects character (merlinsfx.acs). Save the files to the directory where you have installed Microsoft Agent, typically C:\Program Files\Microsoft Agent\.</p></li></ol></div><h4 class="subHeading">To use the Microsoft Agent control</h4><div class="subSection"><ol><li><p>Set up a Microsoft Access data source called Agent and point the data source to the Agent.mdb file contained in the sample's directory as follows: </p><ul><li><p>In Control Panel, select <b>Administrative Tools</b>, then select <b>Data Sources (ODBC)</b>; the ODBC Data Source Administrator dialog box appears.</p></li><li><p>In the ODBC Data Source Administrator dialog box, go to the <b>System DSN</b> tab, then click <b>Add</b>; the Create New Data Source dialog box appears.</p></li><li><p>In the Create New Data Source dialog box, from the list of data sources, choose "Microsoft Access Driver (*.mdb)" then click <b>Finish</b>; the ODBC Microsoft Access Setup dialog box appears.</p></li><li><p>In the ODBC Microsoft Access Setup dialog box, in <b>Data Source Name</b>, type "Agent" then click <b>Advanced</b>; the Set Advanced Options dialog box appears.</p></li><li><p>In <b>Set Advanced Options</b> dialog box, under <b>Options</b>, select DefaultDir, and enter the path to the Agent.mdb file as the DefaultDir property.</p></li></ul></li><li><p>Modify the directory locations at the beginning of AgentCtl.h if you have installed Microsoft Agent in a different directory.</p></li><li><p>Copy the ATLAgent project files and build the ATLAgent project.</p></li><li><p>Open ATLAgent.htm from the sample and click the <b>Play</b> button. The Agent should appear and should follow the instructions contained in the Instructions table in the Agent.mdb database.</p></li></ol></div></div><h1 class="heading">Attributes</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>This sample uses the following attributes:</p><p>coclass, db_column, db_source, db_table, default, dll, dual, helpstring, id, in, module, name, object, out, pointer_default, progid, propget, propput, retval, uuid, vi_progid</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>Some of the samples, such as this one, have not been modified to reflect the changes in the Visual C++ wizards, libraries, and compiler, but still demonstrate how to complete your desired task. </p></td></tr></table></div></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :ATLAgent Attributes Sample: Uses CCommand and CAccessor to Read Information from a Database">comments</a> about this topic to Microsoft.
      </div></div></body></html>
