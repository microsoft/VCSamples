<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>COLLECT Sample: Illustrates MFC Collection Classes</title></head><body><h1>COLLECT Sample: Illustrates MFC Collection Classes</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>The COLLECT sample illustrates a wide variety of collection classes offered by the Microsoft Foundation Class Library (MFC).</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h4 class="subHeading">To build and run the COLLECT sample</h4><div class="subSection"><ol><li><p>Open the solution collect.sln. </p></li><li><p>On the <b>Build</b> menu, click <b>Build</b>. </p></li><li><p>On the <b>Debug</b> menu, click <b>Start Without Debugging</b>. </p></li></ol></div><p>The <b>Example</b> menu lists nine collection class illustrations organized according to the following table. Each example presents a form view that exercises many common collection operations:  </p><ul><li><p>Adding a new element.</p></li><li><p>Inserting a new element in the middle of a list.</p></li><li><p>Searching an element (by clicking its entry in the dialog box's list box).</p></li><li><p>Searching an entry in the map by entering the Key and clicking Find.</p></li><li><p>Updating the value of an element.</p></li><li><p>Removing an element.</p></li><li><p>Removing all the elements of the collection.</p></li></ul><p>You can save changes to all the examples by clicking <b>Save</b> on the <b>File</b> menu and read them back by clicking <b>Open</b> on the <b>File</b> menu.</p></div><h1 class="heading">MFC Collection Classes</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>The MFC collection classes can be classified according to shape and design. MFC offers classes for three types of collection shapes:  </p><ul><li><p>Lists</p></li><li><p>Arrays</p></li><li><p>Maps</p></li></ul><p>MFC also offers three types of designs:  </p><ul><li><p>No use of C++ templates.</p></li><li><p>Use of a C++ template–based collection of simple elements.</p></li><li><p>Use of a C++ template–based collection of type-safe pointers.</p></li></ul><p>The following table identifies all the MFC collection classes sorted according to shape and design. The COLLECT sample illustrates nine of these collections, one from each cell in the table. Each represents a distinct combination of shape and design. Also, because usage of the <b>CTypedPtrArray</b> and <b>CTypedPtrList</b> template-based collections differs according to whether they are used to hold pointers to <b>CObjects</b> or to non-<b>CObject</b>s, the COLLECT sample illustrates both cases. The nine collections illustrated by COLLECT are indicated with an asterisk.</p><h3 class="subHeading"></h3><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr><th>
              Collection shapes
            </th><th>
              Non-template based
            </th><th>
              Template-based simple elements
            </th><th>
              Template-based typeSafe pointers
            </th></tr><tr><td><p>List</p></td><td><p><b>CStringList*</b></p></td><td><p><b>CList*</b></p></td><td><p><b>CTypedPtrList</b></p></td></tr><tr><td><p> </p></td><td><p><b>CObList</b></p></td><td><p> </p></td><td><p>(of pointers)*</p></td></tr><tr><td><p> </p></td><td><p><b>CPtrList</b></p></td><td><p> </p></td><td><p><b>CTypedPtrList</b></p></td></tr><tr><td><p> </p></td><td><p> </p></td><td><p> </p></td><td><p>(of <b>CObject</b>s)</p></td></tr><tr><td><p>Array</p></td><td><p><b>CByteArray</b></p></td><td><p><b>CArray*</b></p></td><td><p><b>CTypedPtrArray</b></p></td></tr><tr><td><p> </p></td><td><p><b>CUIntArray</b></p></td><td><p> </p></td><td><p>(of pointers)</p></td></tr><tr><td><p> </p></td><td><p><b>CWordArray*</b></p></td><td><p> </p></td><td><p> </p></td></tr><tr><td><p> </p></td><td><p><b>CDWordArray</b></p></td><td><p> </p></td><td><p><b>CTypedPtrArray</b></p></td></tr><tr><td><p> </p></td><td><p><b>CStringArray</b></p></td><td><p> </p></td><td><p>(of <b>CObject</b>s)*</p></td></tr><tr><td><p> </p></td><td><p><b>CPtrArray</b></p></td><td><p> </p></td><td><p> </p></td></tr><tr><td><p> </p></td><td><p><b>CObArray</b></p></td><td><p> </p></td><td><p> </p></td></tr><tr><td><p>Map</p></td><td><p><b>CMapWordToPtr</b></p></td><td><p><b>CMap*</b></p></td><td><p><b>CTypedPtrMap*</b></p></td></tr><tr><td><p> </p></td><td><p><b>CMapWordToOb</b></p></td><td><p> </p></td><td><p> </p></td></tr><tr><td><p> </p></td><td><p><b>CMapStringToString*</b></p></td><td><p> </p></td><td><p> </p></td></tr><tr><td><p> </p></td><td><p><b>CMapStringToPtr</b></p></td><td><p> </p></td><td><p> </p></td></tr><tr><td><p> </p></td><td><p><b>CMapStringToOb</b></p></td><td><p> </p></td><td><p> </p></td></tr><tr><td><p> </p></td><td><p><b>CMapPtrToWord</b></p></td><td><p> </p></td><td><p> </p></td></tr><tr><td><p> </p></td><td><p><b>CMapPtrToPtr</b></p></td><td><p> </p></td><td><p> </p></td></tr></table></div></div><h1 class="heading">Additional COLLECT Features</h1><div id="sectionSection2" class="seeAlsoNoToggleSection"><p>In addition to illustrating the MFC collection classes, COLLECT also illustrates:  </p><ul><li><p>Coordinating the addition and removal of entries in a list box with the addition and removal of entries in a collection.</p></li><li><p>Switching between different views of a document, with only one shown at a time. That is, although COLLECT has many different views, it has a single document interface (SDI) instead of a multiple document interface (MDI).</p></li></ul></div><h1 class="heading">Keywords</h1><div id="sectionSection3" class="seeAlsoNoToggleSection"><p>This sample demonstrates the following keywords:</p><p>AfxMessageBox; CCmdUI::SetCheck; CControlBar::EnableDocking; CDialog::DoModal; CDocument::DeleteContents; CDocument::OnNewDocument; CFrameWnd::DockControlBar; CFrameWnd::EnableDocking; CFrameWnd::GetActiveDocument; CFrameWnd::GetActiveView; CFrameWnd::RecalcLayout; CFrameWnd::SetActiveView; CListBox::AddString; CListBox::DeleteString; CListBox::FindString; CListBox::GetCurSel; CListBox::GetItemData; CListBox::GetItemDataPtr; CListBox::GetText; CListBox::InsertString; CListBox::ResetContent; CListBox::SetItemData; CListBox::SetItemDataPtr; CObject::AssertValid; CObject::Dump; CObject::Serialize; CStatusBar::Create; CStatusBar::SetIndicators; CString::Empty; CString::Format; CString::LoadString; CToolBar::Create; CToolBar::LoadBitmap; CToolBar::SetButtons; CView::DoPreparePrinting; CView::GetDocument; CView::OnBeginPrinting; CView::OnDraw; CView::OnEndPrinting; CView::OnInitialUpdate; CView::OnPreparePrinting; CView::OnUpdate; CWinApp::AddDocTemplate; CWinApp::InitInstance; CWinApp::LoadStdProfileSettings; CWinApp::OnFileNew; CWnd::DestroyWindow; CWnd::DoDataExchange; CWnd::OnCreate; CWnd::ShowWindow; CWnd::UpdateData; LoadString; SetWindowLong</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>Some samples, such as this one, have not been modified to reflect the changes in the Visual C++ wizards, libraries, and compiler, but still demonstrate how to complete your desired task. </p></td></tr></table></div></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :COLLECT Sample: Illustrates MFC Collection Classes">comments</a> about this topic to Microsoft.
      </div></div></body></html>
