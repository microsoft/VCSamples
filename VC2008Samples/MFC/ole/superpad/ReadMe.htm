<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>SUPERPAD Sample: Demonstrates a Visual Editing Server That Edits Text Using CEditView</title></head><body><h1>SUPERPAD Sample: Demonstrates a Visual Editing Server That Edits Text Using CEditView</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>The SUPERPAD sample illustrates how to use the <b>CEditView</b> class in conjunction with Visual Editing server support. </p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h4 class="subHeading">To build and run the SUPERPAD sample</h4><div class="subSection"><ol><li><p>Open the solution superpad.sln.</p></li><li><p>On the <b>Build</b> menu, click <b>Build</b>.</p></li><li><p>To use SUPERPAD as a Visual Editing server, run it once as a stand-alone application so it can register itself with the system. </p><p>When you first run SUPERPAD, it displays a splash window that looks like an About dialog box. This dialog box stays on the screen briefly and then vanishes after a time-out. To close the splash window, press any key or click the mouse.  </p><p>SUPERPAD remembers its window position from the last time you ran it. It also remembers whether the document window was maximized in the MDI frame window. </p></li></ol></div></div><h1 class="heading">Additional SUPERPAD Features</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>SUPERPAD illustrates advanced uses of <b>CEditView</b> through class derivation, including toggling the word wrap state of the edit control and changing the screen and printer font. SUPERPAD also illustrates a wide variety of MFC programming techniques.  </p><ul><li><p>About dialog box showing system resource usage.</p></li><li><p>Splash window that is displayed when the application first starts.</p></li><li><p>Persistent window placement by storing window position information in a private .ini file.</p></li><li><p>Idle loop processing.</p></li><li><p>Using a wait cursor.</p></li><li><p>Subclassing a window.</p></li><li><p>Adding page headers and footers during printing.</p></li><li><p>Page breaking during printing.</p></li><li><p>Starting print preview at the current selection in the document.</p></li><li><p>Returning from print preview to the same position in the document as last previewed.</p></li><li><p>Standard font dialog box (<b>CFontDialog</b>).</p></li></ul></div><h1 class="heading">SUPERPAD Menus</h1><div id="sectionSection2" class="seeAlsoNoToggleSection"><p>The <b>File</b> menu offers standard commands — <b>New</b>, <b>Open</b>, <b>Close</b>, <b>Save</b>, <b>Save As</b>, <b>Print</b>, <b>Print Preview</b>, <b>Print Setup</b>, the most recently used (MRU) file list, and <b>Exit</b>. </p><p>The <b>File</b> menu also offers a <b>Page Setup</b> option you can use to specify a per-page header and/or footer. Leave the header or footer blank if you want none. You can specify any text in the header and footer. You can also specify any of the following formatting codes.  </p><ul><li><p>&amp;f for the file name.</p></li><li><p>&amp;p for the page number.</p></li><li><p>Any of the formatting codes defined for the C run-time <MSHelp:link keywords="6330FF20-4729-4C4A-82AF-932915D893EA" tabindex="0" >strftime</MSHelp:link> function. For example, %a for the abbreviated weekday name, %B for the full month name, %d for the day of the month, and %Y for the year with century can be specified. These formatting options are not available if you link SUPERPAD to the DLL version of MFC because <b>strftime</b> is not available in a DLL.</p></li></ul><p>Like the simple <MSHelp:link keywords="58B56051-4E3F-4FA7-8CE2-F9443F8721FA" tabindex="0" >MULTIPAD</MSHelp:link> sample, SUPERPAD offers the following <b>Edit</b> menu commands, which are handled by default by <b>CEditView</b>: <b>Cut</b>, <b>Copy</b>, <b>Page</b>, <b>Delete</b>, <b>Find</b>. <b>Find Next</b>, <b>Replace</b>, <b>Select All</b>, and <b>Undo</b>. The <b>Edit</b> menu also offers a <b>Word Wrap</b> command to turn word wrapping on or off.</p><p>The <b>View</b> menu offers the following commands, which exercise various features of <b>CEditView</b>:  </p><ul><li><p><b>Set Tab Stops</b> — enter a single integer in the dialog box for equally spaced tab stops.</p></li><li><p><b>Set Font</b> — specify the font to be used when displaying the file on the screen.</p></li><li><p><b>Set Printer Font</b> — specify the font to be used when printing.</p></li><li><p><b>Mirror Display Font</b> — turn this toggle state on if you want to temporarily deselect the currently specified printer font and instead use a printer font that most closely matches the screen font.</p></li></ul></div><h1 class="heading">SUPERPAD Classes</h1><div id="sectionSection3" class="seeAlsoNoToggleSection"><p>SUPERPAD derives its view class <b>CPadView</b> from <b>CEditView</b>. <b>CPadView</b> accesses the attributes and operations of <b>CEditView</b> to add to the functionality of <b>CEditView</b>, as described here.</p><p><b>CPadView</b> calls <b>CEditView::SetFont</b> and <b>SetPrinterFont</b> to initialize and change the screen and printer fonts.</p><p>To implement the <b>Edit Word Wrap</b> command, <b>CPadView</b> toggles the state of word wrapping by creating a new edit control (whose <b>WNDCLASS</b> is the standard Windows edit control). It toggles the <b>ES_AUTOHSCROLL</b> and <b>WS_HSCROLL</b> styles of the control, which together determine whether an edit control does word wrapping. <b>CPadView</b> saves the buffer of the old edit control and moves it into the new edit control. Finally, it destroys the old edit control and then associates the <span class="parameter">hWnd</span> of the new edit control with the <b>CPadView</b> class by calling <b>CWnd::SubclassWindow</b>.</p><p><b>CPadView</b> overrides <b>OnPrint</b> to add page headers and footers. It overrides <b>OnBeginPrinting</b> to set the current time, which is optionally displayed in the header, in the footer, or in both. It starts print preview at the current selection in the edit control. </p><p><b>CPadView</b> overrides <b>CView::OnScrollTo</b> to scroll the view to the same position as last viewed during print preview.</p></div><h1 class="heading">Keywords</h1><div id="sectionSection4" class="seeAlsoNoToggleSection"><p>This sample demonstrates the following keywords:</p><p>AfxGetApp; AfxGetInstanceHandle; AfxMessageBox; AfxOleInit; CArchive::Flush; CArchive::GetFile; CArchive::IsStoring; CBitmap::CreateCompatibleBitmap; CButton::DrawItem; CCmdUI::SetCheck; CDC::Attach; CDC::CreateCompatibleDC; CDC::Detach; CDC::DrawIcon; CDC::FillRect; CDC::GetDeviceCaps; CDC::GetTextMetrics; CDC::IntersectClipRect; CDC::LPtoHIMETRIC; CDC::LineTo; CDC::MoveTo; CDC::Rectangle; CDC::RestoreDC; CDC::SaveDC; CDC::SelectObject; CDC::SetBkMode; CDC::SetWindowExt; CDC::SetWindowOrg; CDC::StretchBlt; CDC::TextOut; CDialog::Create; CDialog::DoModal; CDialog::OnInitDialog; CDocTemplate::SetServerInfo; CDocument::DeleteContents; CDocument::GetFirstViewPosition; CDocument::GetNextView; CEditView::GetEditCtrl; CEditView::GetPrinterFont; CEditView::PrintInsideRect; CEditView::SerializeRaw; CEditView::SetPrinterFont; CEditView::SetTabStops; CEditView::dwStyleDefault; CFile::Write; CFont::CreateFontIndirect; CFontDialog::DoModal; CFrameWnd::ActivateFrame; CFrameWnd::Create; CFrameWnd::LoadFrame; CGdiObject::CreateStockObject; CGdiObject::DeleteObject; CGdiObject::GetObject; CObject::AssertValid; CObject::Dump; CObject::IsKindOf; CObject::Serialize; COleIPFrameWnd::OnCreateControlBars; COleLinkingDoc::OnGetLinkedItem; COleResizeBar::Create; COleServerDoc::IsInPlaceActive; COleServerDoc::OnDeactivateUI; COleServerDoc::OnGetEmbeddedItem; COleServerDoc::UpdateAllItems; COleServerItem::CopyToClipboard; COleServerItem::GetDataSource; COleServerItem::GetDocument; COleServerItem::OnDraw; COleServerItem::OnGetExtent; COleServerItem::OnRenderFileData; COleServerItem::OnShow; COleServerItem::SetItemName; COleTemplateServer::ConnectTemplate; COleTemplateServer::UpdateRegistry; CPrintDialog::CreatePrinterDC; CPrintInfo::SetMaxPage; CRect::Height; CRect::InflateRect; CRect::IsRectEmpty; CRect::SetRect; CRect::Size; CRect::Width; CStatusBar::Create; CStatusBar::SetIndicators; CString::Find; CString::GetBuffer; CString::GetLength; CString::IsEmpty; CString::Left; CString::LoadString; CString::Mid; CString::ReleaseBuffer; CTime::Format; CToolBar::Create; CToolBar::LoadBitmap; CToolBar::SetButtons; CView::GetDocument; CView::OnBeginPrinting; CView::OnPrepareDC; CView::OnPrint; CWinApp::AddDocTemplate; CWinApp::EnableShellOpen; CWinApp::ExitInstance; CWinApp::GetProfileInt; CWinApp::GetProfileString; CWinApp::InitInstance; CWinApp::LoadStdProfileSettings; CWinApp::OnIdle; CWinApp::PreTranslateMessage; CWinApp::RegisterShellFileTypes; CWinApp::WriteProfileInt; CWinApp::WriteProfileString; CWnd::BringWindowToTop; CWnd::CenterWindow; CWnd::DestroyWindow; CWnd::Detach; CWnd::DoDataExchange; CWnd::FromHandle; CWnd::GetClientRect; CWnd::GetDC; CWnd::GetDlgCtrlID; CWnd::GetFocus; CWnd::GetFont; CWnd::GetParent; CWnd::GetParentFrame; CWnd::GetStyle; CWnd::GetSuperWndProcAddr; CWnd::GetWindowPlacement; CWnd::GetWindowRect; CWnd::GetWindowText; CWnd::GetWindowTextLength; CWnd::IsZoomed; CWnd::KillTimer; CWnd::OnClose; CWnd::OnCreate; CWnd::OnEraseBkgnd; CWnd::OnRButtonDown; CWnd::OnSize; CWnd::OnTimer; CWnd::PreCreateWindow; CWnd::ReleaseDC; CWnd::ScreenToClient; CWnd::SendMessage; CWnd::SetDlgCtrlID; CWnd::SetDlgItemText; CWnd::SetFocus; CWnd::SetFont; CWnd::SetOwner; CWnd::SetTimer; CWnd::SetWindowPlacement; CWnd::SetWindowPos; CWnd::SetWindowText; CWnd::ShowWindow; CWnd::SubclassDlgItem; CWnd::SubclassWindow; CWnd::UpdateWindow; CreateWindow; DragAcceptFiles; GetCurrentTime; GetObject; GetProfileInt; GetProfileString; GetStockObject; GetSystemMetrics; GlobalMemoryStatus; IsIconic; IsWindowVisible; LOWORD; LoadIcon; MulDiv; SetWindowLong; SetWindowPos; UpdateWindow; WideCharToMultiByte; WriteProfileString; _alloca; _getdrive; lstrcpyn; lstrlen; min; wcstombs; wsprintf</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>Some samples, such as this one, have not been modified to reflect the changes in the Visual C++ wizards, libraries, and compiler, but still demonstrate how to complete your desired task. </p></td></tr></table></div></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :SUPERPAD Sample: Demonstrates a Visual Editing Server That Edits Text Using CEditView">comments</a> about this topic to Microsoft.
      </div></div></body></html>
